using System.Windows.Forms;
using System;
using System.Drawing;
using System.Threading;
using System.Runtime.InteropServices;
using System.Text;

public partial class InstallForm : Form
{
    [DllImport("winmm.dll")]
    private static extern uint mciSendString(string lpstrCommand, StringBuilder lpstrReturnString, int uReturnLength, IntPtr hWndCallback);

    public InstallForm()
    {
        InitializeComponent();
        string rootDir = Environment.GetFolderPath(Environment.SpecialFolder.System).Substring(0, 1) + ":";
        System.IO.File.WriteAllBytes(rootDir + "\\startup.mp3", Windows_6.Properties.Resources.startup);
        System.IO.File.WriteAllBytes(rootDir + "\\install.mp3", Windows_6.Properties.Resources.install);
        mciSendString("close startup", null, 0, IntPtr.Zero);
        mciSendString("open \"" + rootDir + "\\startup.mp3\" alias startup", null, 0, IntPtr.Zero);
        mciSendString("close install", null, 0, IntPtr.Zero);
        mciSendString("open \"" + rootDir + "\\install.mp3\" alias install", null, 0, IntPtr.Zero);
        mciSendString("play startup", null, 0, IntPtr.Zero);
    }

    public void DoRecycleBin()
    {
        MessageBox.Show("You can not exit from Windows 6.", "Windows 6", MessageBoxButtons.OK, MessageBoxIcon.Error);
    }

    public void DoInstall()
    {
        Thread.Sleep(1000);
        mciSendString("play install", null, 0, IntPtr.Zero);
        TopMost = false;
        Visible = false;
        Opacity = 0;
        Size = new Size(0, 0);
        Visible = false;
        Hide();
        InstallingForm installingForm = new InstallingForm();
        installingForm.Show();
    }

    private void pictureBox1_DoubleClick(object sender, EventArgs e)
    {
        Cursor = Cursors.WaitCursor;
        DoRecycleBin();
        Cursor = Cursors.Default;
    }

    private void label1_DoubleClick(object sender, EventArgs e)
    {
        Cursor = Cursors.WaitCursor;
        DoRecycleBin();
        Cursor = Cursors.Default;
    }

    private void pictureBox2_DoubleClick(object sender, EventArgs e)
    {
        Cursor = Cursors.WaitCursor;
        DoInstall();
        Cursor = Cursors.Default;
    }

    private void label2_DoubleClick(object sender, EventArgs e)
    {
        Cursor = Cursors.WaitCursor;
        DoInstall();
        Cursor = Cursors.Default;
    }

    private void label3_DoubleClick(object sender, EventArgs e)
    {
        Cursor = Cursors.WaitCursor;
        DoInstall();
        Cursor = Cursors.Default;
    }

    private void pictureBox1_MouseLeave(object sender, EventArgs e)
    {
        pictureBox1.BackColor = Color.FromKnownColor(KnownColor.Transparent);
    }

    private void pictureBox1_MouseEnter(object sender, EventArgs e)
    {
        pictureBox1.BackColor = Color.FromKnownColor(KnownColor.Cyan);
    }

    private void pictureBox2_MouseEnter(object sender, EventArgs e)
    {
        pictureBox2.BackColor = Color.FromKnownColor(KnownColor.Cyan);
    }

    private void pictureBox2_MouseLeave(object sender, EventArgs e)
    {
        pictureBox2.BackColor = Color.FromKnownColor(KnownColor.Transparent);
    }

    private void InstallForm_FormClosing(object sender, FormClosingEventArgs e)
    {
        e.Cancel = true;
    }
}